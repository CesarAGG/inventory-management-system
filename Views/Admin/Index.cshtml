@model IEnumerable<InventoryManagementSystem.Controllers.UserViewModel>

    @{
    ViewData["Title"] = "Admin - User Management";
    }

    @if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success">@TempData["SuccessMessage"]</div>
}
    @if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
}

    <h2>User Management</h2>

    <form id="userManagementForm" method="post" asp-controller="Admin">
        <div class="card">
            <div class="card-header bg-light">
                <div class="d-flex align-items-center">
                    <h5 class="mb-0">Actions Toolbar</h5>
                    <div class="ms-auto">
                        <button type="submit" class="btn btn-danger" formaction="@Url.Action("BlockUsers")">Block</button>
                        <button type="submit" class="btn btn-success" formaction="@Url.Action("UnblockUsers")">Unblock</button>
                        <button type="submit" class="btn btn-primary" formaction="@Url.Action("AssignAdminRole")">Add to Admin</button>
                        <button type="submit" class="btn btn-warning" formaction="@Url.Action("RemoveAdminRole")">Remove from Admin</button>
                        <button type="submit" class="btn btn-dark" formaction="@Url.Action("DeleteUsers")">Delete</button>
                    </div>
                </div>
            </div>
            <div class="card-body p-0">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th style="width: 50px;">
                                <input class="form-check-input" type="checkbox" id="selectAllCheckbox" />
                            </th>
                            <th>Email</th>
                            <th>Status</th>
                            <th>Role(s)</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var userViewModel in Model)
                    {
                        var user = userViewModel.User;
                        <tr>
                            <td>
                                <input class="form-check-input user-checkbox" type="checkbox" name="selectedUserIds" value="@user.Id" />
                            </td>
                            <td>@user.Email</td>
                            <td>@(user.IsBlocked ? "Blocked" : "Active")</td>
                            <td>@string.Join(", ", userViewModel.Roles)</td>
                        </tr>
                    }
                    </tbody>
                </table>
            </div>
        </div>
    </form>

    @section Scripts {
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const selectAllCheckbox = document.getElementById('selectAllCheckbox');
                const userCheckboxes = document.querySelectorAll('.user-checkbox');

                selectAllCheckbox.addEventListener('change', function () {
                    userCheckboxes.forEach(checkbox => {
                        checkbox.checked = selectAllCheckbox.checked;
                    });
                });
            });
        </script>
    }
